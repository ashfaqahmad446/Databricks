{"version":"NotebookV1","origId":3603969348519362,"name":"03 Streaming Dataset Simulator","language":"python","commands":[{"version":"CommandV1","origId":3603969348519363,"guid":"6be49cce-b43e-4cc6-bf0d-9657baebbe31","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n# Streaming Dataset Simulator\n\n##### This notebook is simulating a streaming dataset by incrementally loading a single order at a time","commandVersion":41,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cdba53a8-f57c-4c18-9936-b25f662005e5"},{"version":"CommandV1","origId":3603969348519364,"guid":"7f7a066e-d953-4971-912d-bb1d286081a8","subtype":"command","commandType":"auto","position":1.75,"command":"# Please update with your specific file path and assign it to the variable orders_full_path\norders_full_path = \"/mnt/streaming-demo/full_dataset/orders_full.csv\"\n\n# Please update with your specific file path and assign it to the variable orders_items_full_path\norder_items_full_path = \"/mnt/streaming-demo/full_dataset/order_items_full.csv\"","commandVersion":26,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"46db66cb-0492-4b1e-972d-e14b8223e2d6"},{"version":"CommandV1","origId":3603969348519365,"guid":"45b7b021-8285-46aa-8ad5-1118897011d5","subtype":"command","commandType":"auto","position":3.0,"command":"# Reading the ORDERS_FULL dataset into a DataFrame called orders_full\norders_full = spark.read.csv(orders_full_path, header=True)\n\n# Reading the ORDER_ITEMS_FULL dataset into a DataFrame called orders_full\norder_items_full = spark.read.csv(order_items_full_path, header=True)","commandVersion":100,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"54072a37-8e60-4821-a939-628886222d71"},{"version":"CommandV1","origId":3603969348519366,"guid":"2e5c5a5c-cba9-4ab5-b09f-f9b47bbc4df4","subtype":"command","commandType":"auto","position":3.001953125,"command":"# Displaying the full orders dataset\norders_full.display()\n\n# Displaying the full orders dataset\norder_items_full.display()","commandVersion":9,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"56119d59-8f3c-46be-9e31-1a06d8047ec9"},{"version":"CommandV1","origId":3603969348519367,"guid":"d99f9d68-f19b-49de-8687-09b6a27b4e13","subtype":"command","commandType":"auto","position":3.0087890625,"command":"# Please update with your specific file path to the streaming dataset and assign it to the variable orders_streaming_path\norders_streaming_path = \"/mnt/streaming-demo/streaming_dataset/orders_streaming.csv\"\n\n# Please update with your specific file path to the streaming dataset and assign it to the variable order_items_streaming_path\norder_items_streaming_path = \"/mnt/streaming-demo/streaming_dataset/order_items_streaming.csv\"","commandVersion":18,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a6c9961b-4e4e-42d1-a24e-a83745eb9fb3"},{"version":"CommandV1","origId":3603969348519368,"guid":"f8637f19-574e-4a79-a467-d03fac8bda99","subtype":"command","commandType":"auto","position":3.015625,"command":"# Loading the first order into the ORDERS_STREAMING dataset\norder_1 = orders_full.filter(orders_full['ORDER_ID']==1)\norder_1.write.options(header=True).mode('append').csv(orders_streaming_path)\n\n# Loading the first order into the ORDER_ITEMS_STREAMING dataset\norder_item_1 = order_items_full.filter(order_items_full['ORDER_ID']==1)\norder_item_1.write.options(header=True).mode('append').csv(order_items_streaming_path)","commandVersion":62,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5aa8cfac-b4ae-486e-b58e-31b9eb53af4e"},{"version":"CommandV1","origId":3603969348519369,"guid":"58c2265c-0991-4bcc-bc0f-3f6fe97667e6","subtype":"command","commandType":"auto","position":3.017578125,"command":"# Reading the orders_streaming dataset via a DataFrame\norders_streaming = spark.read.csv(orders_streaming_path, header=True)\norders_streaming.display()\n\n# Reading the order_items_streaming dataset via a DataFrame\norder_items_streaming = spark.read.csv(order_items_streaming_path, header=True)\norder_items_streaming.display()","commandVersion":47,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0ea55e4a-e3f6-4750-88ea-bc3901fe17dd"},{"version":"CommandV1","origId":3603969348519370,"guid":"a57695ca-281d-4935-9202-2a5b80b0dfb9","subtype":"command","commandType":"auto","position":3.01953125,"command":"# Loading the second order into the ORDERS_STREAMING dataset\norder_2 = orders_full.filter(orders_full['ORDER_ID']==2)\norder_2.write.options(header=True).mode('append').csv(orders_streaming_path)\n\n# Loading the second order into the ORDER_ITEMS_STREAMING dataset\norder_items_2 = order_items_full.filter(order_items_full['ORDER_ID']==2)\norder_items_2.write.options(header=True).mode('append').csv(order_items_streaming_path)","commandVersion":41,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"048c064c-16ea-40ab-a9f9-42de4f6a8745"},{"version":"CommandV1","origId":3603969348519371,"guid":"bbe53301-4311-4ebe-9d82-f2df4315c17d","subtype":"command","commandType":"auto","position":3.0205078125,"command":"# Loading the third order into the ORDERS_STREAMING dataset\norder_3 = orders_full.filter(orders_full['ORDER_ID']==3)\norder_3.write.options(header=True).mode('append').csv(orders_streaming_path)\n\n# Loading the third order into the ORDER_ITEMS_STREAMING dataset\norder_items_3 = order_items_full.filter(order_items_full['ORDER_ID']==3)\norder_items_3.write.options(header=True).mode('append').csv(order_items_streaming_path)","commandVersion":30,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"68c9390a-eb7c-4451-8542-115674f7e9e9"},{"version":"CommandV1","origId":3603969348519372,"guid":"e5b441bb-b22e-464c-b5eb-29568921f3e5","subtype":"command","commandType":"auto","position":3.021484375,"command":"# Loading the 4th and 5th order into the ORDERS_STREAMING dataset\norders_4_5 = orders_full.filter( (orders_full['ORDER_ID'] == 4) | (orders_full['ORDER_ID']==5))\norders_4_5.write.options(header=True).mode('append').csv(orders_streaming_path)\n\n# Loading the 4th and 5th order into the ORDER_ITEMS_STREAMING dataset\norder_items_4_5 = order_items_full.filter( (order_items_full['ORDER_ID'] == 4) | (order_items_full['ORDER_ID']==5))\norder_items_4_5.write.options(header=True).mode('append').csv(order_items_streaming_path)","commandVersion":44,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"45ef6528-9927-4218-ab5f-ffad84cbfa4b"},{"version":"CommandV1","origId":3603969348519373,"guid":"157bd1ba-e2e4-4da2-b34b-48028ab9c2cd","subtype":"command","commandType":"auto","position":4.021484375,"command":"# Deleting the streaming datasets\ndbutils.fs.rm(orders_streaming_path, recurse=True)\ndbutils.fs.rm(order_items_streaming_path, recurse=True)","commandVersion":9,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d163df5a-3a90-4369-9d41-a96fdc4e6d95"},{"version":"CommandV1","origId":3603969348519374,"guid":"ff75075d-5860-47c1-8a43-3d2744bdda8e","subtype":"command","commandType":"auto","position":5.021484375,"command":"","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"10fa6795-50cc-43d5-b35b-8f392dcc20b4"}],"dashboards":[],"guid":"3804944a-2e2b-438c-87fe-8d6c35a1e4d6","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}