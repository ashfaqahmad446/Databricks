{"version":"NotebookV1","origId":3603969348519325,"name":"2 Silver to Gold","language":"python","commands":[{"version":"CommandV1","origId":3603969348519326,"guid":"fbaf4814-fdfb-4f5e-ae65-65f7ff979ffe","subtype":"command","commandType":"auto","position":1.0,"command":"# Reading in the silver table into a dataframe\nhealth_data = spark.read.format(\"delta\").load(\"/mnt/health-updates/silver/health_data\")","commandVersion":34,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"health_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"STATUS_UPDATE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"PATIENT_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DATE_PROVIDED","nullable":true,"type":"date"},{"metadata":{},"name":"FEELING_TODAY","nullable":true,"type":"string"},{"metadata":{},"name":"IMPACT","nullable":true,"type":"string"},{"metadata":{},"name":"INJECTION_SITE_SYMPTOMS","nullable":true,"type":"string"},{"metadata":{},"name":"HIGHEST_TEMP","nullable":true,"type":"double"},{"metadata":{},"name":"FEVERISH_TODAY","nullable":true,"type":"string"},{"metadata":{},"name":"GENERAL_SYMPTOMS","nullable":true,"type":"string"},{"metadata":{},"name":"HEALTHCARE_VISIT","nullable":true,"type":"string"},{"metadata":{},"name":"UPDATED_TIMESTAMP","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":"dbfs:/mnt/health-updates/silver/health_data"}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1667733245630,"submitTime":1667733244493,"finishTime":1667733245800,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"acc17c5c-ce46-497a-9651-0c9a401dd1db"},{"version":"CommandV1","origId":3603969348519327,"guid":"5b46d95b-e510-4ba1-8a44-8a29e88d7853","subtype":"command","commandType":"auto","position":2.0,"command":"# creating the feeling_count_day dataframe\nfeeling_count_day = health_data.groupBy(\"date_provided\",\"feeling_today\").count()","commandVersion":79,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"feeling_count_day","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date_provided","nullable":true,"type":"date"},{"metadata":{},"name":"feeling_today","nullable":true,"type":"string"},{"metadata":{},"name":"count","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1667733256944,"submitTime":1667733256926,"finishTime":1667733256983,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7a5661a1-1214-4b5b-b19c-3c34a52b79f3"},{"version":"CommandV1","origId":3603969348519328,"guid":"4ffec2a1-791d-4679-85f7-c8e16beca488","subtype":"command","commandType":"auto","position":2.5,"command":"# writing the feeling_count_day dataframe as a gold layer table and saving it as an external table\nfeeling_count_day.write.format(\"delta\").mode(\"overwrite\").option(\"path\",\"/mnt/health-updates/gold/feeling_count_day\").saveAsTable(\"healthcare.feeling_count_day\")","commandVersion":31,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1667733288222,"submitTime":1667733288205,"finishTime":1667733291149,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"79a6c025-6102-4712-b054-9092fc81e585"},{"version":"CommandV1","origId":3603969348519329,"guid":"afe3bb6d-0344-4474-855d-67a286d0f439","subtype":"command","commandType":"auto","position":3.0,"command":"# creating the symptom_count_day dataframe\nsymptoms_count_day = health_data.groupBy(\"date_provided\",\"GENERAL_SYMPTOMS\").count()","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"symptoms_count_day","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date_provided","nullable":true,"type":"date"},{"metadata":{},"name":"GENERAL_SYMPTOMS","nullable":true,"type":"string"},{"metadata":{},"name":"count","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1667733293918,"submitTime":1667733293899,"finishTime":1667733293957,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"617c6d14-6779-47c0-a48d-e0807867ca02"},{"version":"CommandV1","origId":3603969348519330,"guid":"aa223c32-de8f-4a06-921d-1f409b612678","subtype":"command","commandType":"auto","position":3.5,"command":"# writing the symptom_count_day dataframe as a gold layer table and saving it as an external table\nsymptoms_count_day.write.format(\"delta\").mode(\"overwrite\").option(\"path\",\"/mnt/health-updates/gold/symptoms_count_day\").saveAsTable(\"healthcare.symptoms_count_day\")","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1667733294636,"submitTime":1667733294619,"finishTime":1667733297259,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"43ceb01f-cacc-4c63-8ded-4f2afa410d88"},{"version":"CommandV1","origId":3603969348519331,"guid":"99132cde-3b0e-4943-bcf0-cc85171fa779","subtype":"command","commandType":"auto","position":4.0,"command":"# creating the healthcare_visit_day dataframe\nhealthcare_visit_day = health_data.groupBy(\"date_provided\",\"healthcare_visit\").count()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"healthcare_visit_day","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date_provided","nullable":true,"type":"date"},{"metadata":{},"name":"healthcare_visit","nullable":true,"type":"string"},{"metadata":{},"name":"count","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1667733297263,"submitTime":1667733295366,"finishTime":1667733297299,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6e814c4c-f813-4403-b430-f1da17f8e11a"},{"version":"CommandV1","origId":3603969348519332,"guid":"7d2a071e-e29b-4fc8-80d5-a6d0bb620932","subtype":"command","commandType":"auto","position":5.0,"command":"# writing the healthcare_visit_day dataframe as a gold layer table and saving it as an external table\nhealthcare_visit_day.write.format(\"delta\").mode(\"overwrite\").option(\"path\",\"/mnt/health-updates/gold/healthcare_visit_day\").saveAsTable(\"healthcare.healthcare_visit_day\")","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1667733302453,"submitTime":1667733302429,"finishTime":1667733304974,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"17c7cd9e-5d22-43a3-99fe-b2ac8298f2ab"},{"version":"CommandV1","origId":3603969348519333,"guid":"7343b337-a269-4594-9d1e-e2137ca8e225","subtype":"command","commandType":"auto","position":6.0,"command":"dbutils.notebook.exit(\"Gold Processing Complete\")","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"80fce1eb-a0da-47b8-9cf1-489dcc6022e0"}],"dashboards":[],"guid":"8472664e-23b1-446c-99df-b7dffdee1b79","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":-1,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}