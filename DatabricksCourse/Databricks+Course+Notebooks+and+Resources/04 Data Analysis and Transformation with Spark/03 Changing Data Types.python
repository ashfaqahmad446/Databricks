{"version":"NotebookV1","origId":3603969348519876,"name":"03 Changing Data Types","language":"python","commands":[{"version":"CommandV1","origId":3603969348519877,"guid":"2e361941-29b2-4039-8fb3-53cd74e2bf3f","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n# Changing Data Types\n\n#### Resources:\n* data types in spark: https://spark.apache.org/docs/latest/sql-ref-datatypes.html\n* cast: https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Column.cast.html?highlight=cast#pyspark.sql.Column.cast","commandVersion":25,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"724897aa-fd29-4924-928a-4560a17dd86c"},{"version":"CommandV1","origId":3603969348519878,"guid":"a96232ca-0624-41f9-b3ab-30db589caf2a","subtype":"command","commandType":"auto","position":1.0,"command":"# Reading in the countries.csv file and specifying the schema\ncountries_path = '/FileStore/tables/countries.csv'\n \nfrom pyspark.sql.types import IntegerType, StringType, DoubleType, StructField, StructType\ncountries_schema = StructType([\n                    StructField(\"COUNTRY_ID\", IntegerType(), False),\n                    StructField(\"NAME\", StringType(), False),\n                    StructField(\"NATIONALITY\", StringType(), False),\n                    StructField(\"COUNTRY_CODE\", StringType(), False),\n                    StructField(\"ISO_ALPHA2\", StringType(), False),\n                    StructField(\"CAPITAL\", StringType(), False),\n                    StructField(\"POPULATION\", DoubleType(), False),\n                    StructField(\"AREA_KM2\", IntegerType(), False),\n                    StructField(\"REGION_ID\", IntegerType(), True),\n                    StructField(\"SUB_REGION_ID\", IntegerType(), True),\n                    StructField(\"INTERMEDIATE_REGION_ID\", IntegerType(), True),\n                    StructField(\"ORGANIZATION_REGION_ID\", IntegerType(), True)\n                    ]\n                    )\n \ncountries=spark.read.csv(path=countries_path, header=True, schema=countries_schema)","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"countries","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"COUNTRY_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"NAME","nullable":true,"type":"string"},{"metadata":{},"name":"NATIONALITY","nullable":true,"type":"string"},{"metadata":{},"name":"COUNTRY_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"ISO_ALPHA2","nullable":true,"type":"string"},{"metadata":{},"name":"CAPITAL","nullable":true,"type":"string"},{"metadata":{},"name":"POPULATION","nullable":true,"type":"double"},{"metadata":{},"name":"AREA_KM2","nullable":true,"type":"integer"},{"metadata":{},"name":"REGION_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"SUB_REGION_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"INTERMEDIATE_REGION_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"ORGANIZATION_REGION_ID","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1665461166386,"submitTime":1665461166335,"finishTime":1665461166535,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e4e39319-73d3-4fae-bc3a-a2430e46ab95"},{"version":"CommandV1","origId":3603969348519879,"guid":"e6952352-9502-4178-914e-ad5a47ec0a44","subtype":"command","commandType":"auto","position":2.0,"command":"countries.dtypes","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[2]: [(&#39;COUNTRY_ID&#39;, &#39;int&#39;),\n (&#39;NAME&#39;, &#39;string&#39;),\n (&#39;NATIONALITY&#39;, &#39;string&#39;),\n (&#39;COUNTRY_CODE&#39;, &#39;string&#39;),\n (&#39;ISO_ALPHA2&#39;, &#39;string&#39;),\n (&#39;CAPITAL&#39;, &#39;string&#39;),\n (&#39;POPULATION&#39;, &#39;double&#39;),\n (&#39;AREA_KM2&#39;, &#39;int&#39;),\n (&#39;REGION_ID&#39;, &#39;int&#39;),\n (&#39;SUB_REGION_ID&#39;, &#39;int&#39;),\n (&#39;INTERMEDIATE_REGION_ID&#39;, &#39;int&#39;),\n (&#39;ORGANIZATION_REGION_ID&#39;, &#39;int&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1665461216530,"submitTime":1665461216506,"finishTime":1665461216568,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",550]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"befc98d0-c25d-4fcf-b96e-a564bf8a129c"},{"version":"CommandV1","origId":3603969348519880,"guid":"bf08abb5-da08-469e-9f77-cc68a5776fbe","subtype":"command","commandType":"auto","position":3.0,"command":"# Reading the countries file without specifying the schema, into a new variable\ncountries_dt = spark.read.csv(path=countries_path, header=True)","commandVersion":36,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"countries_dt","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"COUNTRY_ID","nullable":true,"type":"string"},{"metadata":{},"name":"NAME","nullable":true,"type":"string"},{"metadata":{},"name":"NATIONALITY","nullable":true,"type":"string"},{"metadata":{},"name":"COUNTRY_CODE","nullable":true,"type":"string"},{"metadata":{},"name":"ISO_ALPHA2","nullable":true,"type":"string"},{"metadata":{},"name":"CAPITAL","nullable":true,"type":"string"},{"metadata":{},"name":"POPULATION","nullable":true,"type":"string"},{"metadata":{},"name":"AREA_KM2","nullable":true,"type":"string"},{"metadata":{},"name":"REGION_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SUB_REGION_ID","nullable":true,"type":"string"},{"metadata":{},"name":"INTERMEDIATE_REGION_ID","nullable":true,"type":"string"},{"metadata":{},"name":"ORGANIZATION_REGION_ID","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1665461269204,"submitTime":1665461269167,"finishTime":1665461270101,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6db357b9-6a77-4ad5-ae32-a7f820777763"},{"version":"CommandV1","origId":3603969348519881,"guid":"66f75d02-a3e5-4357-aa6c-df959675fe5e","subtype":"command","commandType":"auto","position":4.0,"command":"# Note the data types are all string\ncountries_dt.dtypes","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[4]: [(&#39;COUNTRY_ID&#39;, &#39;string&#39;),\n (&#39;NAME&#39;, &#39;string&#39;),\n (&#39;NATIONALITY&#39;, &#39;string&#39;),\n (&#39;COUNTRY_CODE&#39;, &#39;string&#39;),\n (&#39;ISO_ALPHA2&#39;, &#39;string&#39;),\n (&#39;CAPITAL&#39;, &#39;string&#39;),\n (&#39;POPULATION&#39;, &#39;string&#39;),\n (&#39;AREA_KM2&#39;, &#39;string&#39;),\n (&#39;REGION_ID&#39;, &#39;string&#39;),\n (&#39;SUB_REGION_ID&#39;, &#39;string&#39;),\n (&#39;INTERMEDIATE_REGION_ID&#39;, &#39;string&#39;),\n (&#39;ORGANIZATION_REGION_ID&#39;, &#39;string&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1665461280559,"submitTime":1665461280533,"finishTime":1665461280589,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",568]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a7f27bd7-a5b6-483c-9714-303575fa8f70"},{"version":"CommandV1","origId":3603969348519882,"guid":"89851296-f43d-49ee-b7c4-713ee0e48e23","subtype":"command","commandType":"auto","position":5.0,"command":"# Using the cast method to cast the population column as IntegerType(), IntegerType() has already been imported in the first cell\ncountries_dt.select(countries_dt['population'].cast(IntegerType())).dtypes","commandVersion":48,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[6]: [(&#39;population&#39;, &#39;int&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1665461395795,"submitTime":1665461395768,"finishTime":1665461395830,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",74]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2ddc9000-be13-45a4-a70a-4f9b33f2738c"},{"version":"CommandV1","origId":3603969348519883,"guid":"cc4241da-a4bf-4a0e-8aa9-b89cf05667be","subtype":"command","commandType":"auto","position":6.0,"command":"# Using the cast method to cast the population column as StringType(), StringType() has already been imported in the first cell\ncountries.select(countries['population'].cast(StringType())).dtypes","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[7]: [(&#39;population&#39;, &#39;string&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1665461445723,"submitTime":1665461445686,"finishTime":1665461445766,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",77]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ad3838fd-7728-477f-896a-edd37eacde6f"}],"dashboards":[],"guid":"413a745e-30d1-40ee-8532-993dbb307b84","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}