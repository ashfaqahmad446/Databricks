{"version":"NotebookV1","origId":3603969348519309,"name":"02 Reading a Data Stream","language":"python","commands":[{"version":"CommandV1","origId":3603969348519310,"guid":"b0db2507-4f84-47c7-b351-ecc7d000ad7c","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n# Reading a Data Stream\n\n#### Resources:\n* Structured Streaming API: https://spark.apache.org/docs/latest/api/python/reference/pyspark.ss/index.html\n* DataStreamReader API: https://spark.apache.org/docs/latest/api/python/reference/pyspark.ss/api/pyspark.sql.streaming.DataStreamReader.html\n* DataStreamWriter API: https://spark.apache.org/docs/latest/api/python/reference/pyspark.ss/api/pyspark.sql.streaming.DataStreamWriter.html\n* Input / Output: https://spark.apache.org/docs/latest/api/python/reference/pyspark.ss/io.html\n* Query Management: https://spark.apache.org/docs/latest/api/python/reference/pyspark.ss/query_management.html","commandVersion":6,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"72f28c3f-137f-4a14-825e-a4ec696a736d"},{"version":"CommandV1","origId":3603969348519311,"guid":"cf9cce2c-d2ae-48a0-ab86-143cecda6648","subtype":"command","commandType":"auto","position":1.0,"command":"# import the relevant data types\nfrom pyspark.sql.types import IntegerType, StringType, DoubleType, StructField, StructType\n\n# For a streaming source DataFrame we must define the schema\n# Please update with your specific file path and assign it to the variable orders_full_path\norders_streaming_path = \"/mnt/streaming-demo/streaming_dataset/orders_streaming.csv\"\n \norders_schema = StructType([\n                    StructField(\"ORDER_ID\", IntegerType(), False),\n                    StructField(\"ORDER_DATETIME\", StringType(), False),\n                    StructField(\"CUSTOMER_ID\", IntegerType(), False),\n                    StructField(\"ORDER_STATUS\", StringType(), False),\n                    StructField(\"STORE_ID\", IntegerType(), False)\n                    ]\n                    )","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1677437551562,"submitTime":1677437551512,"finishTime":1677437551674,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9c6e0dbf-116a-4e3c-a38e-cb687e12bd4a"},{"version":"CommandV1","origId":3603969348519312,"guid":"eb39ca03-f2a7-4b33-8eb9-3fbf3033a7c8","subtype":"command","commandType":"auto","position":2.0,"command":"# reading the streaming data into a dataframe called orders_sdf\norders_sdf = spark.readStream.csv(orders_streaming_path, orders_schema, header=True )","commandVersion":28,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders_sdf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"ORDER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"ORDER_DATETIME","nullable":true,"type":"string"},{"metadata":{},"name":"CUSTOMER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"ORDER_STATUS","nullable":true,"type":"string"},{"metadata":{},"name":"STORE_ID","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1677437633971,"submitTime":1677437633903,"finishTime":1677437634248,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a0f40174-9a78-49fb-a43b-f9841f23b967"},{"version":"CommandV1","origId":3603969348519313,"guid":"e330450f-d3e2-4f22-8658-89ae891beb48","subtype":"command","commandType":"auto","position":5.0,"command":"# displaying the dataframe initialises the stream\norders_sdf.display()","commandVersion":14,"state":"finished","results":{"type":"table","data":[[1,"11-AUG-21 09.04.36.00",3,"CANCELLED",1],[2,"16-AUG-21 04.42.24.00",45,"COMPLETE",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"ORDER_ID","type":"\"integer\"","metadata":"{}"},{"name":"ORDER_DATETIME","type":"\"string\"","metadata":"{}"},{"name":"CUSTOMER_ID","type":"\"integer\"","metadata":"{}"},{"name":"ORDER_STATUS","type":"\"string\"","metadata":"{}"},{"name":"STORE_ID","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1677437679989,"submitTime":1677437679989,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1157","height":"100","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{"69902017-aa84-4e50-8cc0-d6f686f45db0":[{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:54:41.310Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":429,\"getBatch\":109,\"queryPlanning\":149,\"triggerExecution\":2721,\"walCommit\":275,\"addBatch\":1420,\"commitOffsets\":260},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":1,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.3658982802780827}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:54:55.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":36,\"triggerExecution\":36},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:55:05.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":35,\"triggerExecution\":36},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:55:15.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":38,\"triggerExecution\":38},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:55:26.001Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":35,\"triggerExecution\":35},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:55:36.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":36,\"triggerExecution\":37},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:55:47.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":31,\"triggerExecution\":32},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:55:57.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":31,\"triggerExecution\":31},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:56:07.001Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":31,\"triggerExecution\":31},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":0,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":336},\"memoryUsedBytes\":480,\"commitTimeMs\":140,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":185}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:56:12.000Z\",\"inputRowsPerSecond\":1.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":340,\"getBatch\":88,\"queryPlanning\":7,\"triggerExecution\":1242,\"walCommit\":197,\"addBatch\":396,\"commitOffsets\":213},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":1,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.8051529790660226}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:56:24.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":35,\"triggerExecution\":35},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:56:34.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":34,\"triggerExecution\":35},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:56:44.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":63,\"triggerExecution\":64},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:56:55.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":35,\"triggerExecution\":36},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:57:06.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":54,\"triggerExecution\":55},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:57:17.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":77,\"triggerExecution\":77},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:57:28.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":31,\"triggerExecution\":31},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":\"display_query_1\",\"timestamp\":\"2023-02-26T18:57:38.000Z\",\"inputRowsPerSecond\":0.0,\"id\":\"d26503c3-d207-4fd7-9c65-02a792a16c73\",\"durationMs\":{\"latestOffset\":45,\"triggerExecution\":46},\"stateOperators\":[{\"numRowsTotal\":1,\"numShufflePartitions\":1,\"operatorName\":\"globalLimit\",\"numStateStoreInstances\":1,\"numRowsRemoved\":0,\"numRowsUpdated\":0,\"numRowsDroppedByWatermark\":0,\"customMetrics\":{\"loadedMapCacheHitCount\":1,\"loadedMapCacheMissCount\":0,\"stateOnCurrentVersionSizeBytes\":280},\"memoryUsedBytes\":768,\"commitTimeMs\":134,\"allRemovalsTimeMs\":0,\"allUpdatesTimeMs\":87}],\"processedRowsPerSecond\":0.0}"},{"name":"69902017-aa84-4e50-8cc0-d6f686f45db0","isActive":false,"sources":[{"description":"FileStreamSource[dbfs:/mnt/streaming-demo/streaming_dataset/orders_streaming.csv]","latestOffset":"{\"logOffset\":1}"}],"sink":{"description":"MemorySink","latestOffset":"[{\"logOffset\":1}]"},"exception":null,"version":2,"progressJson":"{\n  \"id\" : \"d26503c3-d207-4fd7-9c65-02a792a16c73\",\n  \"runId\" : \"69902017-aa84-4e50-8cc0-d6f686f45db0\",\n  \"name\" : \"display_query_1\",\n  \"timestamp\" : \"2023-02-26T18:57:38.000Z\",\n  \"batchId\" : 2,\n  \"numInputRows\" : 0,\n  \"inputRowsPerSecond\" : 0.0,\n  \"processedRowsPerSecond\" : 0.0,\n  \"durationMs\" : {\n    \"latestOffset\" : 45,\n    \"triggerExecution\" : 46\n  },\n  \"stateOperators\" : [ {\n    \"operatorName\" : \"globalLimit\",\n    \"numRowsTotal\" : 1,\n    \"numRowsUpdated\" : 0,\n    \"allUpdatesTimeMs\" : 87,\n    \"numRowsRemoved\" : 0,\n    \"allRemovalsTimeMs\" : 0,\n    \"commitTimeMs\" : 134,\n    \"memoryUsedBytes\" : 768,\n    \"numRowsDroppedByWatermark\" : 0,\n    \"numShufflePartitions\" : 1,\n    \"numStateStoreInstances\" : 1,\n    \"customMetrics\" : {\n      \"loadedMapCacheHitCount\" : 1,\n      \"loadedMapCacheMissCount\" : 0,\n      \"stateOnCurrentVersionSizeBytes\" : 280\n    }\n  } ],\n  \"sources\" : [ {\n    \"description\" : \"FileStreamSource[dbfs:/mnt/streaming-demo/streaming_dataset/orders_streaming.csv]\",\n    \"startOffset\" : {\n      \"logOffset\" : 1\n    },\n    \"endOffset\" : {\n      \"logOffset\" : 1\n    },\n    \"latestOffset\" : null,\n    \"numInputRows\" : 0,\n    \"inputRowsPerSecond\" : 0.0,\n    \"processedRowsPerSecond\" : 0.0\n  } ],\n  \"sink\" : {\n    \"description\" : \"MemorySink\",\n    \"numOutputRows\" : 0\n  }\n}"}]},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",2]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"80a49130-c850-4ec1-a624-59c9c7eeb467"}],"dashboards":[],"guid":"65f7d7e7-a171-4abc-b0ef-ddc3929bdcb7","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}